# Security Policy Configuration
# Â© 2025 Negative Space Imaging, Inc. - CONFIDENTIAL

apiVersion: security.banzaicloud.io/v1alpha1
kind: SecurityPolicy
metadata:
  name: quantum-security-policy
  namespace: negative-space-system
spec:
  encryptionConfig:
    provider: quantum
    keyRotation:
      enabled: true
      interval: 1h
    algorithms:
      - CRYSTALS-Kyber
      - CRYSTALS-Dilithium
    providers:
      - name: quantum
        vault:
          address: https://vault.negative-space-system:8200
          path: quantum/keys
          role: encryption-service

  networkPolicy:
    ingress:
      defaultDeny: true
      allowedPorts:
        - port: 443
          protocol: TCP
    egress:
      defaultDeny: true
      allowedDomains:
        - vault.negative-space-system

  podSecurity:
    defaultDeny: true
    seccomp:
      defaultProfile: runtime/default
    seLinux:
      rule: MustRunAs
      role: quantum-encryptor
    runAsUser:
      rule: MustRunAsNonRoot
    runAsGroup:
      rule: MustRunAs
      ranges:
        - min: 1000
          max: 1000
    supplementalGroups:
      rule: MustRunAs
      ranges:
        - min: 1000
          max: 1000
    fsGroup:
      rule: MustRunAs
      ranges:
        - min: 1000
          max: 1000

  auditPolicy:
    level: RequestResponse
    stages:
      - RequestReceived
      - ResponseComplete
    omitStages:
      - RequestReceived
    rules:
      - level: RequestResponse
        resources:
          - group: ""
            resources: ["secrets"]
      - level: Metadata
        resources:
          - group: ""
            resources: ["pods"]
