{% extends "base.html" %} {% block title %}Optimization Settings{% endblock %} {% block content %}
<div class="container-fluid">
  <h1 class="mt-4 mb-4">Optimization Settings</h1>

  <div class="row">
    <!-- Optimization Level Card -->
    <div class="col-md-12">
      <div class="card mb-4">
        <div class="card-header">
          <h5 class="card-title mb-0">Global Optimization Level</h5>
        </div>
        <div class="card-body">
          <form method="post" action="{{ url_for('performance.settings_update') }}">
            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <label for="optimizationLevel">Optimization Level</label>
                  <select class="form-select" id="optimizationLevel" name="optimization_level">
                    {% for level in optimization_levels %}
                    <option
                      value="{{ level }}"
                      {%
                      if
                      level=""
                      ="optimization_level"
                      %}selected{%
                      endif
                      %}
                    >
                      {{ level }}
                    </option>
                    {% endfor %}
                  </select>
                </div>
                <div class="mt-3">
                  <button type="submit" class="btn btn-primary">Apply Settings</button>
                </div>
              </div>
              <div class="col-md-6">
                <div class="card mb-0 border-0">
                  <div class="card-body bg-light">
                    <h6>Optimization Levels</h6>
                    <dl class="row mb-0">
                      <dt class="col-sm-3">NONE</dt>
                      <dd class="col-sm-9">No optimization, baseline performance</dd>

                      <dt class="col-sm-3">MINIMAL</dt>
                      <dd class="col-sm-9">Basic optimizations with minimal resource usage</dd>

                      <dt class="col-sm-3">STANDARD</dt>
                      <dd class="col-sm-9">Balanced optimization for general use</dd>

                      <dt class="col-sm-3">AGGRESSIVE</dt>
                      <dd class="col-sm-9">Maximum performance, higher resource usage</dd>

                      <dt class="col-sm-3">QUANTUM</dt>
                      <dd class="col-sm-9">Experimental quantum optimization techniques</dd>
                    </dl>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <!-- Performance Thresholds -->
    <div class="col-md-12">
      <div class="card mb-4">
        <div class="card-header">
          <h5 class="card-title mb-0">Performance Thresholds</h5>
        </div>
        <div class="card-body">
          <form method="post" action="{{ url_for('performance.settings_update') }}">
            <div class="row">
              <div class="col-md-4">
                <div class="mb-3">
                  <label for="thresholdCpu" class="form-label">CPU Usage Threshold (%)</label>
                  <input
                    type="number"
                    class="form-control"
                    id="thresholdCpu"
                    name="threshold_cpu_usage"
                    value="{{ thresholds.cpu_usage }}"
                    min="1"
                    max="100"
                  />
                  <div class="form-text">CPU usage that triggers optimization</div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mb-3">
                  <label for="thresholdMemory" class="form-label">Memory Usage Threshold (%)</label>
                  <input
                    type="number"
                    class="form-control"
                    id="thresholdMemory"
                    name="threshold_memory_usage"
                    value="{{ thresholds.memory_usage }}"
                    min="1"
                    max="100"
                  />
                  <div class="form-text">Memory usage that triggers optimization</div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mb-3">
                  <label for="thresholdResponseTime" class="form-label"
                    >Response Time Threshold (ms)</label
                  >
                  <input
                    type="number"
                    class="form-control"
                    id="thresholdResponseTime"
                    name="threshold_response_time"
                    value="{{ thresholds.response_time }}"
                    min="1"
                    max="10000"
                  />
                  <div class="form-text">Response time that triggers optimization</div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-4">
                <div class="mb-3">
                  <label for="thresholdCacheHitRate" class="form-label"
                    >Cache Hit Rate Threshold (%)</label
                  >
                  <input
                    type="number"
                    class="form-control"
                    id="thresholdCacheHitRate"
                    name="threshold_cache_hit_rate"
                    value="{{ thresholds.cache_hit_rate }}"
                    min="1"
                    max="100"
                  />
                  <div class="form-text">Minimum acceptable cache hit rate</div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mb-3">
                  <label for="thresholdThreadContention" class="form-label"
                    >Thread Contention Threshold (%)</label
                  >
                  <input
                    type="number"
                    class="form-control"
                    id="thresholdThreadContention"
                    name="threshold_thread_contention"
                    value="{{ thresholds.thread_contention }}"
                    min="1"
                    max="100"
                  />
                  <div class="form-text">Thread contention that triggers optimization</div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mb-3">
                  <label for="thresholdDiskIO" class="form-label">Disk I/O Threshold (MB/s)</label>
                  <input
                    type="number"
                    class="form-control"
                    id="thresholdDiskIO"
                    name="threshold_disk_io"
                    value="{{ thresholds.disk_io }}"
                    min="1"
                    max="1000"
                  />
                  <div class="form-text">Disk I/O that triggers optimization</div>
                </div>
              </div>
            </div>
            <button type="submit" class="btn btn-primary">Save Thresholds</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <!-- Component Profiles -->
    <div class="col-md-12">
      <div class="card mb-4">
        <div class="card-header">
          <h5 class="card-title mb-0">Component Optimization Profiles</h5>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped table-hover">
              <thead>
                <tr>
                  <th>Component</th>
                  <th>Status</th>
                  <th>Optimization Level</th>
                  <th>Cache</th>
                  <th>Parallelization</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                {% for name, profile in components.items() %}
                <tr>
                  <td>{{ name }}</td>
                  <td>
                    {% if profile.enabled %}
                    <span class="badge bg-success">Enabled</span>
                    {% else %}
                    <span class="badge bg-danger">Disabled</span>
                    {% endif %}
                  </td>
                  <td>{{ profile.level }}</td>
                  <td>
                    {% if profile.cache_enabled %}
                    <span class="badge bg-success">Enabled</span>
                    {% else %}
                    <span class="badge bg-danger">Disabled</span>
                    {% endif %}
                  </td>
                  <td>
                    {% if profile.parallel_enabled %}
                    <span class="badge bg-success">Enabled</span>
                    {% else %}
                    <span class="badge bg-danger">Disabled</span>
                    {% endif %}
                  </td>
                  <td>
                    <a
                      href="{{ url_for('performance.component_detail', component_name=name) }}"
                      class="btn btn-sm btn-primary"
                    >
                      Configure
                    </a>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <!-- System-wide Optimization -->
    <div class="col-md-12">
      <div class="card mb-4">
        <div class="card-header">
          <h5 class="card-title mb-0">System-wide Optimization</h5>
        </div>
        <div class="card-body">
          <form method="post" action="{{ url_for('performance.optimize') }}">
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="optimizationTarget" class="form-label">Optimization Target</label>
                  <select class="form-select" id="optimizationTarget" name="target">
                    {% for target in optimization_targets %}
                    <option value="{{ target }}">{{ target }}</option>
                    {% endfor %}
                  </select>
                  <div class="form-text">What aspect of the system to optimize</div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="componentName" class="form-label">Component (Optional)</label>
                  <select class="form-select" id="componentName" name="component">
                    <option value="">All Components</option>
                    {% for name in components.keys() %}
                    <option value="{{ name }}">{{ name }}</option>
                    {% endfor %}
                  </select>
                  <div class="form-text">Specific component to optimize (leave blank for all)</div>
                </div>
              </div>
            </div>
            <div class="mt-3">
              <button type="submit" class="btn btn-success">Run Optimization</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <!-- Advanced Settings -->
    <div class="col-md-12">
      <div class="card mb-4">
        <div class="card-header">
          <h5 class="card-title mb-0">Advanced Settings</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6">
              <form method="post" action="{{ url_for('performance.settings_update_advanced') }}">
                <h6>Threading & Parallelization</h6>
                <div class="mb-3">
                  <label for="maxThreads" class="form-label">Maximum Threads</label>
                  <input
                    type="number"
                    class="form-control"
                    id="maxThreads"
                    name="max_threads"
                    value="{{ advanced_settings.max_threads }}"
                    min="1"
                    max="128"
                  />
                </div>
                <div class="mb-3">
                  <label for="maxProcesses" class="form-label">Maximum Processes</label>
                  <input
                    type="number"
                    class="form-control"
                    id="maxProcesses"
                    name="max_processes"
                    value="{{ advanced_settings.max_processes }}"
                    min="1"
                    max="32"
                  />
                </div>
                <div class="mb-3">
                  <label for="threadingModel" class="form-label">Threading Model</label>
                  <select class="form-select" id="threadingModel" name="threading_model">
                    <option
                      value="ADAPTIVE"
                      {%
                      if
                      advanced_settings.threading_model=""
                      ="ADAPTIVE"
                      %}selected{%
                      endif
                      %}
                    >
                      Adaptive
                    </option>
                    <option
                      value="FIXED"
                      {%
                      if
                      advanced_settings.threading_model=""
                      ="FIXED"
                      %}selected{%
                      endif
                      %}
                    >
                      Fixed
                    </option>
                    <option
                      value="DYNAMIC"
                      {%
                      if
                      advanced_settings.threading_model=""
                      ="DYNAMIC"
                      %}selected{%
                      endif
                      %}
                    >
                      Dynamic
                    </option>
                  </select>
                </div>
                <button type="submit" class="btn btn-primary">Save Advanced Settings</button>
              </form>
            </div>
            <div class="col-md-6">
              <form method="post" action="{{ url_for('performance.settings_update_scheduler') }}">
                <h6>Optimization Scheduler</h6>
                <div class="form-check mb-3">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="enableScheduler"
                    name="scheduler_enabled"
                    {%
                    if
                    advanced_settings.scheduler_enabled
                    %}checked{%
                    endif
                    %}
                  />
                  <label class="form-check-label" for="enableScheduler">
                    Enable Automatic Optimization Scheduler
                  </label>
                </div>
                <div class="mb-3">
                  <label for="schedulerInterval" class="form-label"
                    >Schedule Interval (minutes)</label
                  >
                  <input
                    type="number"
                    class="form-control"
                    id="schedulerInterval"
                    name="scheduler_interval"
                    value="{{ advanced_settings.scheduler_interval }}"
                    min="5"
                    max="1440"
                  />
                </div>
                <div class="mb-3">
                  <label for="optimizationTime" class="form-label"
                    >Preferred Optimization Time</label
                  >
                  <input
                    type="time"
                    class="form-control"
                    id="optimizationTime"
                    name="optimization_time"
                    value="{{ advanced_settings.optimization_time }}"
                  />
                  <div class="form-text">Time to run resource-intensive optimizations</div>
                </div>
                <button type="submit" class="btn btn-primary">Save Scheduler Settings</button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <!-- Performance Options -->
    <div class="col-md-12">
      <div class="card mb-4">
        <div class="card-header">
          <h5 class="card-title mb-0">Performance Options</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-3 text-center mb-3">
              <a href="{{ url_for('performance.dashboard') }}" class="btn btn-primary btn-lg w-100">
                <i class="fas fa-chart-line mb-2"></i><br />
                Dashboard
              </a>
            </div>
            <div class="col-md-3 text-center mb-3">
              <a href="{{ url_for('performance.details') }}" class="btn btn-info btn-lg w-100">
                <i class="fas fa-tachometer-alt mb-2"></i><br />
                Performance Details
              </a>
            </div>
            <div class="col-md-3 text-center mb-3">
              <a href="{{ url_for('performance.memory') }}" class="btn btn-success btn-lg w-100">
                <i class="fas fa-memory mb-2"></i><br />
                Memory Optimization
              </a>
            </div>
            <div class="col-md-3 text-center mb-3">
              <a href="{{ url_for('performance.cache') }}" class="btn btn-warning btn-lg w-100">
                <i class="fas fa-database mb-2"></i><br />
                Cache Management
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script>
  // Auto-refresh every 5 minutes
  setTimeout(function () {
    location.reload();
  }, 300000);
</script>
{% endblock %}
